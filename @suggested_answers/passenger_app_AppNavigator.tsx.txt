// @suggested_answers/passenger_app_AppNavigator.tsx.txt
// This is a new file that should be placed at:
// bao-ride-passenger/src/AppNavigator.tsx

import React, { useState } from 'react';
import { useAuth } from './src/AuthContext';
import LoginScreen from './src/screens/LoginScreen';
import RegisterScreen from './src/screens/RegisterScreen';
import HomeScreen from './src/screens/HomeScreen';
import { View, ActivityIndicator, StyleSheet } from 'react-native';

// This component will now control which screen is visible
export default function AppNavigator() {
  const { user, isLoading } = useAuth();
  // This local state will control switching between Login and Register
  const [showRegister, setShowRegister] = useState(false);

  // Show a loading screen while we check for a stored user session
  if (isLoading) {
    return (
      <View style={styles.loadingContainer}>
        <ActivityIndicator size="large" color="#0000ff" />
      </View>
    );
  }

  // If there is a logged-in user, show the main HomeScreen
  if (user) {
    return <HomeScreen />;
  }

  // If there is no user, show either Login or Register screen based on local state
  if (showRegister) {
    // We will pass a function to the Register screen to allow it to switch back
    return <RegisterScreen onSwitchToLogin={() => setShowRegister(false)} />;
  } else {
    // We will pass a function to the Login screen to allow it to switch
    return <LoginScreen onSwitchToRegister={() => setShowRegister(true)} />;
  }
}

const styles = StyleSheet.create({
  loadingContainer: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
  },
});
